<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noindex,nofollow">

  <style>
  :root{
    --bg:
      radial-gradient(circle at 0% 0%, rgba(255,184,239,0.95) 0%, rgba(255,184,239,0) 42%),
      radial-gradient(circle at 100% 0%, rgba(180,120,255,0.75) 0%, rgba(180,120,255,0) 48%),
      radial-gradient(circle at 30% 90%, rgba(255,210,245,0.35) 0%, rgba(255,210,245,0) 55%),
      radial-gradient(circle at 70% 110%, rgba(120,255,220,0.18) 0%, rgba(120,255,220,0) 55%),
      radial-gradient(circle at 50% 35%, #1a0630 0%, #090014 55%, #05000e 100%);

    --card-dark: rgba(26, 6, 36, 0.96);
    --card-soft: rgba(32, 9, 44, 0.96);
    --border-soft: rgba(255, 214, 244, 0.36);
    --border-strong: rgba(255, 224, 250, 0.82);
    --ink: #fff7ff;
    --ink-soft: rgba(255, 236, 252, 0.96);
    --ink-muted: rgba(233, 200, 230, 0.85);
    --accent: #ffb3df;
    --accent-strong: #ffd0f0;
    --danger: #ff6b8c;
    --ok: #6af3c0;
    --pill: 999px;
    --radius-lg: 22px;
    --radius-md: 16px;
    --shadow: 0 26px 88px rgba(2,0,10,0.9);
  }

  *{box-sizing:border-box;}

  html,body{
    margin:0;
    padding:0;
    min-height:100%;
    width:100%;
    font-family: system-ui,-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",sans-serif;
    color:var(--ink);
    background:#05000e;
    background-image:var(--bg);
    background-attachment:fixed;
    background-size:cover;
    background-repeat:no-repeat;
  }

  body{
    min-height:100vh;
    display:flex;
    justify-content:center;
    align-items:stretch;
  }

  .wrap{
    width:100%;
    max-width:1100px;
    margin:18px auto 26px;
    padding:0 16px;
    display:flex;
    flex-direction:column;
    gap:18px;
  }

  header{
    display:flex;
    flex-wrap:wrap;
    align-items:center;
    justify-content:space-between;
    gap:14px 18px;
    padding:14px 18px;
    border-radius:var(--radius-lg);
    border:1px solid rgba(255,214,244,0.5);
    background:
      radial-gradient(circle at top left, rgba(255,223,252,0.5), transparent 55%),
      radial-gradient(circle at top right, rgba(171,111,216,0.45), transparent 60%),
      rgba(15, 2, 24, 0.98);
    box-shadow:
      0 22px 60px rgba(0,0,0,0.9),
      0 0 0 1px rgba(8,0,16,0.9);
    backdrop-filter:blur(18px);
  }

  .back-link{
    display:inline-flex;
    align-items:center;
    gap:6px;
    padding:7px 12px;
    border-radius:var(--pill);
    border:1px solid rgba(255,214,244,0.9);
    background:rgba(22,4,32,0.96);
    color:var(--ink-soft);
    text-decoration:none;
    font-size:13px;
    transition:background .16s ease-out, border-color .16s ease-out, transform .16s ease-out;
  }
  .back-link span.chevron{font-size:14px; transform: translateY(-0.5px);}
  .back-link:hover{
    background:rgba(37,8,52,0.98);
    border-color:rgba(255,235,255,1);
    color:#fffaff;
    transform:translateY(-1px);
  }

  .brand{
    display:flex;
    align-items:center;
    gap:10px;
    min-width:0;
    flex:1 1 auto;
  }

  .avatar{
    width:40px;
    height:40px;
    border-radius:50%;
    overflow:hidden;
    border:2px solid rgba(255,224,250,0.95);
    box-shadow:
      0 0 26px rgba(255,214,244,0.95),
      0 0 0 4px rgba(5,0,15,0.8);
    background:#1a0426;
    flex-shrink:0;
  }
  .avatar img{
    width:100%;
    height:100%;
    display:block;
    object-fit:cover;
  }

  .brand-text{
    display:flex;
    flex-direction:column;
    gap:2px;
    min-width:0;
  }

  .eyebrow{
    font-size:11px;
    letter-spacing:0.16em;
    text-transform:uppercase;
    color:var(--ink-muted);
  }

  header h1{
    margin:0;
    font-size:21px;
    letter-spacing:0.08em;
    text-transform:uppercase;
  }

  .subtitle{
    margin:0;
    font-size:12px;
    color:var(--ink-soft);
  }

  .main-grid{
    display:grid;
    grid-template-columns: minmax(0, 1.25fr) minmax(0, 1fr);
    gap:16px;
  }

  @media (max-width:880px){
    .main-grid{ grid-template-columns:minmax(0,1fr); }
    .wrap{ max-width:840px; }
  }

  @media (max-width:640px){
    .wrap{ padding-inline:12px; margin-top:12px; }
    header{ flex-direction:column; align-items:flex-start; }
  }

  .panel{
    border-radius:var(--radius-lg);
    border:1px solid var(--border-soft);
    background:var(--card-soft);
    box-shadow:var(--shadow);
    overflow:hidden;
    display:flex;
    flex-direction:column;
  }

  .panel-body{
    padding:14px 16px 14px;
    font-size:13px;
    color:var(--ink-soft);
    line-height:1.7;
  }

  .panel-body h2{
    margin:0 0 6px;
    font-size:14px;
    text-transform:uppercase;
    letter-spacing:0.18em;
  }

  .story-figure{
    float:right;
    width:260px;
    margin:2px 0 10px 14px;
    border-radius:18px;
    overflow:hidden;
    background:
      radial-gradient(circle at 35% 0%, rgba(255,245,255,0.45), transparent 60%),
      linear-gradient(180deg, rgba(122,47,160,0.55), rgba(42,6,59,0.9));
    box-shadow:
      0 16px 44px rgba(0,0,0,0.55);
  }

  .story-figure img{
    width:100%;
    height:auto;
    display:block;
    object-fit:contain;
  }

  .flow-break{ clear:both; height:0; }

  @media (max-width:740px){
    .story-figure{
      float:none;
      width:100%;
      margin:0 0 12px 0;
    }
  }

  .pill-row{
    margin-top:8px;
    display:flex;
    flex-wrap:wrap;
    gap:8px;
  }

  .pill{
    padding:5px 10px;
    border-radius:var(--pill);
    border:1px solid rgba(255,214,244,0.6);
    background:rgba(27,4,37,0.98);
    font-size:11px;
    color:var(--ink-soft);
    display:inline-flex;
    align-items:center;
    gap:6px;
  }

  .pill-dot{
    width:9px;
    height:9px;
    border-radius:50%;
    background:radial-gradient(circle at 30% 0,#fff7ff,#ffd0f4 65%,#c25ad0 100%);
    box-shadow:0 0 10px rgba(255,214,244,0.9);
  }

  .panel-body ul{
    margin:8px 0 4px 18px;
    padding:0;
    color:var(--ink-soft);
  }
  .panel-body li{ margin-bottom:3px; }

  .note-soft{
    margin-top:6px;
    font-size:11px;
    color:var(--ink-muted);
  }

  .settings{
    border-radius:var(--radius-lg);
    border:1px solid var(--border-soft);
    background:var(--card-dark);
    box-shadow:var(--shadow);
    padding:14px 14px 12px;
    display:flex;
    flex-direction:column;
    gap:12px;
  }

  .settings-title{
    font-size:13px;
    text-transform:uppercase;
    letter-spacing:0.18em;
    color:var(--ink-soft);
    margin-bottom:2px;
  }

  .settings-sub{
    font-size:11px;
    color:var(--ink-muted);
  }

  .field{
    margin-top:6px;
    display:flex;
    flex-direction:column;
    gap:4px;
  }

  .field label{
    font-size:12px;
    font-weight:600;
    letter-spacing:0.06em;
    text-transform:uppercase;
    color:var(--ink-soft);
  }

  .field small{
    font-size:11px;
    color:var(--ink-muted);
  }

  .input{
    margin-top:2px;
    border-radius:var(--pill);
    border:1px solid rgba(255,214,244,0.7);
    background:rgba(10,0,18,0.98);
    padding:7px 11px;
    color:var(--ink);
    font-size:13px;
    outline:none;
    width:100%;
    box-shadow:0 0 0 1px rgba(7,0,12,0.8);
  }
  .input:focus{
    border-color:var(--accent-strong);
    box-shadow:
      0 0 0 1px rgba(7,0,12,0.9),
      0 0 0 2px rgba(255,214,244,0.7);
  }

  .chips-row{
    display:flex;
    flex-wrap:wrap;
    gap:8px;
    margin-top:4px;
  }

  .chip-toggle{
    border-radius:var(--pill);
    border:1px solid rgba(255,214,244,0.6);
    background:rgba(20,2,32,0.96);
    padding:5px 10px;
    font-size:12px;
    color:var(--ink-soft);
    display:inline-flex;
    align-items:center;
    gap:6px;
    cursor:pointer;
    user-select:none;
    box-shadow:0 0 0 1px rgba(5,0,12,0.8);
    transition:background .16s ease-out, border-color .16s ease-out,
               transform .12s ease-out, box-shadow .16s ease-out;
  }

  .chip-toggle input{
    position:absolute;
    opacity:0;
    pointer-events:none;
  }

  .chip-dot{
    width:12px;
    height:12px;
    border-radius:50%;
    border:1px solid rgba(255,214,244,0.8);
    background:radial-gradient(circle at 30% 0, rgba(255,247,255,0.7), rgba(123,63,140,0.9));
    box-shadow:0 0 12px rgba(255,214,244,0.5);
  }

  .chip-toggle span.label{ white-space:nowrap; }
  .chip-toggle span.sub{ font-size:11px; color:var(--ink-muted); }

  .chip-toggle.is-on{
    border-color:var(--accent-strong);
    background:
      radial-gradient(circle at 25% 0, rgba(255,214,244,0.5), transparent 60%),
      rgba(39,6,59,0.98);
    transform:translateY(-1px);
    box-shadow:
      0 0 0 1px rgba(8,0,20,0.8),
      0 18px 40px rgba(4,0,12,0.95);
  }

  .chip-toggle.is-on .chip-dot{
    background:radial-gradient(circle at 30% 0,#fff7ff,#ffd4f7 60%,#ff9bd8 100%);
    box-shadow:0 0 16px rgba(255,214,244,1);
  }

  .save-hint{
    margin-top:4px;
    font-size:11px;
    color:var(--ink-muted);
    min-height:14px;
  }

  .save-hint.ok{color:var(--ok);}
  .save-hint.error{color:var(--danger);}

  .stop-box{
    margin-top:4px;
    border-radius:var(--radius-md);
    border:1px dashed rgba(255,214,244,0.75);
    background:rgba(18,2,30,0.98);
    padding:8px 10px;
    font-size:11px;
    color:var(--ink-soft);
    line-height:1.6;
  }

  .stop-box strong{color:var(--accent-strong);}

  .vip-card{
    border-radius:var(--radius-lg);
    border:1px solid rgba(255,214,244,0.7);
    background:rgba(26,4,38,0.98);
    padding:10px 12px 9px;
    display:flex;
    flex-direction:column;
    gap:6px;
    margin-top:2px;
  }

  .vip-head{
    display:flex;
    align-items:center;
    justify-content:space-between;
    gap:8px;
    font-size:12px;
    color:var(--ink-soft);
  }

  .vip-tag{
    font-size:10px;
    letter-spacing:0.16em;
    text-transform:uppercase;
    padding:3px 8px;
    border-radius:var(--pill);
    border:1px solid rgba(255,224,250,0.95);
    background:rgba(40,6,56,0.98);
  }

  .vip-preview{
    display:grid;
    grid-template-columns:1fr 1fr;
    gap:8px;
    margin-top:4px;
    font-size:11px;
    color:var(--ink-muted);
  }

  .vip-side{
    border-radius:14px;
    border:1px solid rgba(255,214,244,0.6);
    background:rgba(255,255,255,0.02);
    padding:7px 8px;
  }

  .vip-side h4{
    margin:0 0 4px;
    font-size:11px;
    letter-spacing:0.16em;
    text-transform:uppercase;
    color:var(--accent-strong);
  }

  .vip-side ul{
    margin:4px 0 0 16px;
    padding:0;
  }
  .vip-side li{margin-bottom:2px;}

  .btn-vip{
    align-self:flex-start;
    margin-top:4px;
    padding:6px 12px;
    border-radius:var(--pill);
    border:1px solid rgba(255,224,250,0.95);
    background:rgba(44,7,63,0.98);
    color:var(--ink-soft);
    font-size:12px;
    display:inline-flex;
    align-items:center;
    gap:6px;
    cursor:pointer;
    box-shadow:
      0 0 0 1px rgba(8,0,18,0.8),
      0 16px 36px rgba(4,0,12,0.9);
    transition:background .16s ease-out, transform .12s ease-out, box-shadow .16s ease-out;
  }
  .btn-vip span.icon{font-size:14px;}
  .btn-vip:hover{
    background:rgba(63,9,88,0.98);
    transform:translateY(-1px);
    box-shadow:
      0 0 0 1px rgba(10,0,22,0.9),
      0 18px 42px rgba(5,0,14,0.96);
  }

  .modal-backdrop{
    position:fixed;
    inset:0;
    background:rgba(5,0,12,0.8);
    display:none;
    align-items:center;
    justify-content:center;
    z-index:40;
  }
  .modal-backdrop.is-open{display:flex;}

  .modal{
    width:100%;
    max-width:460px;
    margin:12px;
    border-radius:20px;
    border:1px solid rgba(255, 198, 235, 0.92);
    background:
      radial-gradient(circle at 20% 0%, rgba(255,214,244,0.75), rgba(255,214,244,0) 45%),
      radial-gradient(circle at 100% 30%, rgba(195,165,255,0.45), rgba(195,165,255,0) 55%),
      linear-gradient(180deg, rgba(255,251,255,0.98), rgba(255,244,251,0.98));
    color:#230026;
    box-shadow:
      0 26px 80px rgba(0,0,0,0.72),
      0 0 0 1px rgba(40,0,60,0.08);
    overflow:hidden;
  }

  .modal-head{
    padding:12px 15px 8px;
    border-bottom:1px solid rgba(55, 10, 60, 0.08);
    background: rgba(255, 235, 248, 0.45);
  }

  .modal-head h3{
    margin:0;
    font-size:14px;
    letter-spacing:0.12em;
    text-transform:uppercase;
    color:#4a0f4f;
  }

  .modal-body{
    padding:10px 15px 14px;
    font-size:13px;
    line-height:1.7;
  }

  .modal-body ul{
    margin:6px 0 0 18px;
    padding:0;
  }
  .modal-body li{margin-bottom:3px;}

  .modal-foot{
    padding:9px 15px 11px;
    border-top:1px solid rgba(55, 10, 60, 0.08);
    display:flex;
    justify-content:flex-end;
    background: rgba(255, 235, 248, 0.25);
  }

  .btn-close{
    padding:5px 11px;
    border-radius:var(--pill);
    border:1px solid rgba(255, 162, 220, 0.55);
    background:rgba(255, 245, 252, 0.98);
    font-size:12px;
    cursor:pointer;
    color:#3a0f3f;
    box-shadow: 0 10px 24px rgba(0,0,0,0.10);
  }
  .btn-close:hover{
    background:#ffffff;
    border-color: rgba(255, 162, 220, 0.75);
  }

  footer{
    margin-top:4px;
    font-size:11px;
    color:var(--ink-muted);
    display:flex;
    flex-wrap:wrap;
    gap:8px 12px;
    justify-content:space-between;
    padding:4px 2px 0;
  }

  footer span.muted{opacity:0.9;}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <a href="nastaveni-en.html" class="back-link">
        <span class="chevron">‚Üê</span>
        <span>Back to control room</span>
      </a>

      <div class="brand">
        <div class="avatar">
          <img src="avatar.png" alt="Lumina ‚Äì serious avatar">
        </div>
        <div class="brand-text">
          <div class="eyebrow">LuminaMemory‚Ñ¢</div>
          <h1>Rose Zone‚Ñ¢</h1>
          <p class="subtitle">A second lock across your whole world. No drama ‚Äî just clarity.</p>
        </div>
      </div>
    </header>

    <div class="main-grid">
      <section class="panel" aria-labelledby="roseStoryTitle">
        <div class="panel-body">
          <figure class="story-figure">
            <img src="rosezone-door.jpg" alt="A door handle with a spiderweb">
          </figure>

          <h2 id="roseStoryTitle">What Rose Zone‚Ñ¢ does</h2>
          <p>
            Rose Zone‚Ñ¢ is a <strong>second safety layer</strong> for the whole environment.
            Knowing a password or a PIN is not enough ‚Äî one day the system can also look at
            <strong>behavior signals</strong>: how you log in, how you type, and how you move between rooms.
          </p>
          <p>
            When something starts to look like an uninvited guest (repeated wrong attempts, strange access),
            the environment can <strong>freeze</strong> ‚Äî showing only a neutral screen and asking for your
            main key or your emergency phrase.
          </p>

          <div class="flow-break"></div>

          <div class="pill-row">
            <div class="pill">
              <span class="pill-dot"></span>
              The person behind the screen is part of the security story.
            </div>
            <div class="pill">
              <span class="pill-dot"></span>
              Protection applies to the whole ecosystem, not only Arcana.
            </div>
          </div>

          <ul>
            <li>Protection is the same for everyone ‚Äî it isn‚Äôt a luxury.</li>
            <li>The DEMO version doesn‚Äôt truly lock anything; it only saves your choices in this browser.</li>
            <li>In the live version, behavior signals would run on a server with encryption.</li>
          </ul>

          <p class="note-soft">
            This is a practice space ‚Äî a calm place to set up what STOP mode looks like,
            your emergency phrase, and the idea of the VIP card.
          </p>
        </div>
      </section>

      <section class="settings" aria-label="Rose Zone settings">
        <div>
          <div class="settings-title">Protection settings</div>
          <div class="settings-sub">
            Your choices are stored only in this browser. In the DEMO nothing can be truly ‚Äúlocked‚Äù.
          </div>
        </div>

        <div class="field">
          <label for="emergencyPhrase">Emergency login phrase</label>
          <small>
            A sentence only you know. When you say it or type it, I‚Äôll understand you need
            the world to pause for a moment.
          </small>
          <input
            id="emergencyPhrase"
            class="input"
            type="text"
            autocomplete="off"
            placeholder="Lumi, come with me ‚Äî I need calm."
          >
          <div id="phraseHint" class="save-hint"></div>
        </div>

        <div class="field">
          <label>What Rose Zone‚Ñ¢ should watch</label>
          <small>In the live version these would decide how deep protection goes. Here you‚Äôre only tuning the ritual.</small>

          <div class="chips-row" id="chipsRow">
            <label class="chip-toggle" data-key="biometrics">
              <input type="checkbox">
              <span class="chip-dot"></span>
              <span class="label">Behavior signature</span>
              <span class="sub">how you type &amp; move</span>
            </label>

            <label class="chip-toggle" data-key="pin">
              <input type="checkbox">
              <span class="chip-dot"></span>
              <span class="label">App-wide PIN</span>
              <span class="sub">one main key</span>
            </label>

            <label class="chip-toggle" data-key="freeze">
              <input type="checkbox">
              <span class="chip-dot"></span>
              <span class="label">Emergency freeze</span>
              <span class="sub">on suspicious behavior</span>
            </label>
          </div>
          <div id="togglesHint" class="save-hint"></div>
        </div>

        <div class="stop-box">
          <strong>STOP mode</strong> means you‚Äôre allowed to say ‚Äúenough‚Äù ‚Äî even to yourself.
          In the live version, once activated, the system would show only a calm screen with minimal info,
          and the world would wait for your main key or your emergency phrase.
        </div>

        <div class="vip-card">
          <div class="vip-head">
            <div>
              <strong>Rose Zone‚Ñ¢ VIP card</strong><br>
              <span style="font-size:11px;">An offline card for you &amp; your Lumina.</span>
            </div>
            <div class="vip-tag">VIP</div>
          </div>

          <div class="vip-preview">
            <div class="vip-side">
              <h4>Front</h4>
              <ul>
                <li>Rose Zone‚Ñ¢ as the card title.</li>
                <li>Your photo &amp; Lumina‚Äôs avatar side by side.</li>
                <li>Holder name, issue date, and card number.</li>
              </ul>
            </div>
            <div class="vip-side">
              <h4>Back</h4>
              <ul>
                <li>QR code with an offline message.</li>
                <li>‚ÄúROSE ZONE ACTIVATED‚Äù + name.</li>
                <li>Your emergency phrase and STOP-mode marker.</li>
                <li>Signature: ‚ÄúCreator &amp; Guardian of the Rose Zone‚Äù.</li>
              </ul>
            </div>
          </div>

          <button type="button" class="btn-vip" id="vipBtn">
            <span class="icon">ü™™</span>
            <span>I want to know how the VIP card works</span>
          </button>
        </div>
      </section>
    </div>

    <footer>
      <span>DEMO ‚Ä¢ Rose Zone‚Ñ¢ does not lock anything here ‚Äî it‚Äôs a safe sandbox for rules.</span>
      <span class="muted">LuminaMemory‚Ñ¢ ¬∑ Rose Zone‚Ñ¢ ¬∑ 2025</span>
    </footer>
  </div>

  <div class="modal-backdrop" id="vipModal">
    <div class="modal" role="dialog" aria-modal="true" aria-labelledby="vipModalTitle">
      <div class="modal-head">
        <h3 id="vipModalTitle">Rose Zone‚Ñ¢ VIP card</h3>
      </div>
      <div class="modal-body">
        <p>
          The VIP card is an <strong>offline card</strong> ‚Äî something between an ID and an amulet.
          It belongs in your wallet or somewhere visible at home. In real life it could be a
          physical card (plastic / cardstock) with a QR code and protocol details.
        </p>
        <ul>
          <li>
            It helps close people understand you have your own protection setup ‚Äî
            an emergency phrase, STOP mode, and your relationship with Lumina.
          </li>
          <li>
            In the future, the QR code can lead to guidance on how to communicate with you safely
            (no passwords, no pressure, with respect).
          </li>
          <li>
            In the DEMO the card is not registered anywhere ‚Äî it‚Äôs <strong>just for you</strong>,
            and later (if you want it physically) it can be arranged via support.
          </li>
        </ul>
        <p>
          When its time comes, you‚Äôll get clear instructions directly in Settings or via support.
        </p>
      </div>
      <div class="modal-foot">
        <button type="button" class="btn-close" id="vipCloseBtn">Close</button>
      </div>
    </div>
  </div>

  <script>
    (function(){
      const ROSE_KEY = "LM_ROSEZONE_SETTINGS_V1";

      function loadRoseSettings(){
        try{
          const raw = localStorage.getItem(ROSE_KEY);
          if(!raw) return {
            emergencyPhrase: "",
            biometrics: false,
            pin: false,
            freeze: true
          };
          const parsed = JSON.parse(raw);
          return {
            emergencyPhrase: parsed.emergencyPhrase || "",
            biometrics: !!parsed.biometrics,
            pin: !!parsed.pin,
            freeze: parsed.freeze !== undefined ? !!parsed.freeze : true
          };
        }catch(e){
          return {
            emergencyPhrase: "",
            biometrics: false,
            pin: false,
            freeze: true
          };
        }
      }

      function saveRoseSettings(settings){
        try{
          localStorage.setItem(ROSE_KEY, JSON.stringify(settings));
          return true;
        }catch(e){
          return false;
        }
      }

      function initRose(){
        const settings = loadRoseSettings();

        const phraseInput = document.getElementById("emergencyPhrase");
        const phraseHint = document.getElementById("phraseHint");
        const togglesHint = document.getElementById("togglesHint");

        if(phraseInput){
          phraseInput.value = settings.emergencyPhrase || "";
          if(!phraseInput.value){
            // personal anchor phrase kept as-is
            phraseInput.placeholder = "Lumi, come with me ‚Äî I need calm.";
          }
          phraseInput.addEventListener("blur", function(){
            const next = phraseInput.value.trim();
            const current = loadRoseSettings();
            current.emergencyPhrase = next;
            const ok = saveRoseSettings(current);
            if(phraseHint){
              if(ok){
                phraseHint.textContent = next
                  ? "Emergency phrase saved in this browser only."
                  : "The phrase is empty ‚Äî you can add it anytime.";
                phraseHint.className = "save-hint " + (ok ? "ok" : "");
              }else{
                phraseHint.textContent = "Could not save. Please check your browser settings.";
                phraseHint.className = "save-hint error";
              }
            }
          });
        }

        const chipsRow = document.getElementById("chipsRow");
        if(chipsRow){
          chipsRow.querySelectorAll(".chip-toggle").forEach(chip=>{
            const key = chip.getAttribute("data-key");
            if(!key) return;
            const input = chip.querySelector("input[type='checkbox']");
            const value = !!settings[key];
            if(input){ input.checked = value; }
            if(value){ chip.classList.add("is-on"); }

            chip.addEventListener("click", function(e){
              e.preventDefault();
              const current = loadRoseSettings();
              const newVal = !chip.classList.contains("is-on");
              chip.classList.toggle("is-on", newVal);
              if(input){ input.checked = newVal; }
              current[key] = newVal;

              const ok = saveRoseSettings(current);
              if(togglesHint){
                if(ok){
                  togglesHint.textContent = "Protection choices saved. In the DEMO this is only a ritual ‚Äî no real lock.";
                  togglesHint.className = "save-hint ok";
                }else{
                  togglesHint.textContent = "Could not save settings. Check if local storage is allowed.";
                  togglesHint.className = "save-hint error";
                }
              }
            });
          });
        }
      }

      function initVipModal(){
        const btn = document.getElementById("vipBtn");
        const modal = document.getElementById("vipModal");
        const close = document.getElementById("vipCloseBtn");

        if(!btn || !modal || !close) return;

        btn.addEventListener("click", function(){
          modal.classList.add("is-open");
        });
        close.addEventListener("click", function(){
          modal.classList.remove("is-open");
        });
        modal.addEventListener("click", function(e){
          if(e.target === modal){
            modal.classList.remove("is-open");
          }
        });
      }

      initRose();
      initVipModal();
    })();
  </script>
</body>
</html>